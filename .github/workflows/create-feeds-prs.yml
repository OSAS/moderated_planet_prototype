---
name: "Generate PRs for feeds"

on: workflow_dispatch
# when ready for production
#on:
#  schedule:
#    - cron: '3 * * * *'

jobs:
  update-feeds:
    name: "Update feeds"
    runs-on: ubuntu-latest
    steps:
      - name: "Checkout project"
        uses: actions/checkout@v2
      - name: "Fetch previous artifacts"
        uses: dawidd6/action-download-artifact@v2
        with:
          # there is no variable for this
          # https://github.community/t/access-workflow-filename-even-when-name-is-defined/17641
          workflow: create-feeds-prs.yml
          workflow_conclusion: success
          name: pluto-files
          path: .
          check_artifacts:  False
        continue-on-error: True
      - name: "Update feeds"
        uses: OSAS/github-pluto-feeds@master
      - name: "Save updated artifacts"
        uses: actions/upload-artifact@v2
        with:
          name: pluto-files
          path: planet.db
          if-no-files-found: error

